webpackJsonp([17],{"6bjw":function(t,a,e){a=t.exports=e("FZ+f")(!1),a.push([t.i,"\n.grant-box[data-v-513831b4]{text-align:left;cursor:pointer\n}\n.grant-box>div[data-v-513831b4]{height:6px;background:#00a65a;border-radius:3px\n}\n.grant-box>div.grant-color-s[data-v-513831b4]{width:100%;background:#00a65a\n}\n.grant-box>div.grant-color-f[data-v-513831b4]{width:0;background:#dd4b39\n}\n.grant-box>div.grant-color-half[data-v-513831b4]{width:50%;background:#e6a23c\n}\n.grant-box>span[data-v-513831b4]{padding:0px 6px;height:18px;display:inline-block;border-radius:10px;text-align:center;color:#fff;line-height:18px;font-size:12px\n}\n.grant-box>span.grant-num-s[data-v-513831b4]{background:#00a65a\n}\n.grant-box>span.grant-num-f[data-v-513831b4]{background:#dd4b39\n}\n.grant-box>span.grant-num-half[data-v-513831b4]{background:#e6a23c\n}\n",""])},naQB:function(t,a,e){var i=e("6bjw");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);e("rjj0")("4a7b05e6",i,!0)},sDKi:function(t,a,e){"use strict";function i(t){e("naQB")}Object.defineProperty(a,"__esModule",{value:!0});var o,s=e("bOdI"),n=e.n(s),r=e("TtmE"),l=e("pOg+"),c=e("18Ef"),u=(o={name:"home",data:function(){return{msg:"通道规则",currentPage:1,popVisible:!1,popTitle:"这个是标题",popContent:"这个是内容",total:0,tableData:[],multipleSelection:[],value:"",value1:"",dataForm:{appId:"",personName:"",pageNum:1,pageSize:10,visitorPassble:"",time:""},visitorPassble:[{value:1,label:"有效"},{value:2,label:"无效"},{value:3,label:"过期"},{value:4,label:"取消"}],loading:!1,imgurl:"",outChecked:!1,outPop:!1,isExport:!1,authPopVisible:!1,authPopTitle:"",authId:"",authName:"",timer:null}},filters:{},created:function(){this.imgurl=this.tools.global.API_URL},computed:{appId:{get:function(){return this.$store.state.project.projectId},set:function(t){this.$store.commit("changeProjectId",t)}}},watch:{appId:function(t,a){this.appId=t,this.dataForm={appId:t,personName:"",pageNum:1,pageSize:10,visitorPassble:"",time:""},this.getTableData()}},components:{MsgBox:r.a,ExportBox:l.a,AuthBox:c.a}},n()(o,"filters",{clTime:function(t){return t.split(" ")[0]}}),n()(o,"mounted",function(){this.appId&&(this.dataForm.appId=this.appId,this.getTableData())}),n()(o,"methods",{getTableData:function(){var t=this;this.loading=!0,this.utils.http({url:"/person/visitor/record/queryVisitorByPage",method:"GET",params:this.dataForm},function(a){200==a.code&&(t.total=a.data.total,t.tableData=a.data.records,t.currentPage=a.data.current),t.loading=!1})},resetBtn:function(){this.dataForm={appId:this.appId,personName:"",pageNum:1,pageSize:10,visitorPassble:"",time:""},this.getTableData()},changeTime:function(t){},open:function(){var t=this;this.timer=setTimeout(function(){t.popVisible=!1,clearTimeout(t.timer)},3e3)},clearSetTimeOut:function(){clearTimeout(this.timer)},handleNodeClick:function(t){console.log(t)},handleSelectionChange:function(t){this.multipleSelection=t},handleSizeChange:function(t){this.dataForm.pageSize=t,this.getTableData()},handleCurrentChange:function(t){this.dataForm.pageNum=t,this.getTableData()},clickDel:function(t){var a=this;this.$confirm("您确信取消当前记录?","确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.deleteRequest(t)}).catch(function(){})},deleteRequest:function(t){var a=this;this.utils.http({url:"/person/visitor/record/cancelVisitorAuth",method:"GET",params:{visitorId:t}},function(t){200==t.code&&(a.utils.tip("success","取消成功"),a.getTableData())})},batchDelete:function(){var t=this,a=[];this.multipleSelection.forEach(function(t,e){a.push(t.id)}),0==a.length?(this.popVisible=!0,this.popTitle="提示",this.popContent="请先选择要取消的访客",this.open()):this.$confirm("您确信取消选中的访客?","确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.utils.http({url:"/person/visitor/record/batchCancelVisitorAuth",method:"POST",data:{visitIdList:a}},function(a){200==a.code&&(t.utils.tip("success","取消成功"),t.getTableData())})}).catch(function(){})},exportBtn:function(){this.outPop=!0},outBtn:function(){var t=this;this.isExport=!0,this.outChecked=this.$refs.exportData.outChecked,this.outChecked?this.dataForm.withPic=1:this.dataForm.withPic=0;var a=[];this.multipleSelection.forEach(function(t,e){a.push(t.id)}),this.dataForm.ids=a,this.utils.http({url:"/person/visitor/record/exportVisitor",method:"POST",data:this.dataForm},function(a){t.isExport=!1,t.outPop=!1,delete t.dataForm.ids,200==a.code?t.$alert("人员正在导出请稍后","提示",{confirmButtonText:"确定",dangerouslyUseHTMLString:!0,closeOnClickModal:!0,type:"success"}).then(function(){}).catch(function(){}):t.$alert("人员导出失败","提示",{confirmButtonText:"确定",dangerouslyUseHTMLString:!0,closeOnClickModal:!0,type:"error"}).then(function(){}).catch(function(){})})},goView:function(t,a){this.authPopVisible=!0,this.authId=t,this.authPopTitle=a}}),o),p=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"content-wrapper"},[t._m(0),t._v(" "),e("section",{staticClass:"content container-fluid"},[e("div",{staticClass:"box box-primary"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"box-body"},[e("div",{staticClass:"form-horizontal"},[e("div",{staticClass:"col-lg-2 pl-0"},[e("div",{staticClass:"form-group"},[e("div",{staticClass:"col-md-12"},[e("el-input",{staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"搜索姓名"},model:{value:t.dataForm.personName,callback:function(a){t.$set(t.dataForm,"personName",a)},expression:"dataForm.personName"}})],1)])]),t._v(" "),e("div",{staticClass:"col-lg-3"},[e("div",{staticClass:"form-group"},[e("div",{staticClass:"col-md-12"},[e("el-date-picker",{staticStyle:{width:"100%"},attrs:{clearable:"",type:"date",placeholder:"访问日期",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd hh:mm:ss"},on:{change:t.changeTime},model:{value:t.dataForm.time,callback:function(a){t.$set(t.dataForm,"time",a)},expression:"dataForm.time"}})],1)])]),t._v(" "),e("div",{staticClass:"col-lg-2"},[e("div",{staticClass:"form-group"},[e("div",{staticClass:"col-md-12"},[e("el-select",{attrs:{clearable:"",placeholder:"状态"},model:{value:t.dataForm.visitorPassble,callback:function(a){t.$set(t.dataForm,"visitorPassble",a)},expression:"dataForm.visitorPassble"}},t._l(t.visitorPassble,function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)])]),t._v(" "),e("div",{staticClass:"col-lg-4  pr-0"},[e("div",{staticClass:"btn-group"},[e("button",{staticClass:"btn btn-primary",attrs:{id:"btn_device_search",type:"button"},on:{click:t.getTableData}},[e("span",{staticClass:"glyphicon glyphicon-search",attrs:{"aria-hidden":"true"}}),t._v("查询\n                        ")]),t._v(" "),e("button",{staticClass:"btn btn-default",attrs:{id:"btn_device_reset",type:"button"},on:{click:t.resetBtn}},[e("span",{staticClass:"fa fa-reply",attrs:{"aria-hidden":"true"}}),t._v("重置\n                        ")])])])]),t._v(" "),e("div",{staticClass:" btn-group-box",staticStyle:{width:"100%"},attrs:{id:"toolbar"}},[e("div",{staticClass:"btn-group",attrs:{"data-toggle":"buttons"}},[e("button",{staticClass:"btn btn-default",attrs:{id:"btn_delete",type:"button"},on:{click:t.exportBtn}},[e("span",{staticClass:"glyphicon glyphicon-arrow-down",attrs:{"aria-hidden":"true"}}),t._v("导出\n                      ")]),t._v(" "),e("button",{staticClass:"btn btn-default",attrs:{id:"btn_add",type:"button"},on:{click:t.batchDelete}},[e("span",{staticClass:"glyphicon glyphicon-remove",attrs:{"aria-hidden":"true"}}),t._v("批量取消\n                      ")])])]),t._v(" "),e("el-table",{ref:"multipleTable",staticClass:"mt-10",staticStyle:{width:"100%"},attrs:{data:t.tableData,border:!0,"cell-style":{background:"#fff",fontSize:"14px",color:"#12111D",padding:"6px 0"},stripe:!0,"default-sort":{prop:"date",order:"descending"}},on:{"selection-change":t.handleSelectionChange}},[e("el-table-column",{attrs:{type:"selection",width:"40"}}),t._v(" "),e("el-table-column",{attrs:{prop:"visitTime",label:"访问时间",align:"center","min-width":"120",sortable:""},scopedSlots:t._u([{key:"default",fn:function(a){return[a.row.visitTime?e("span",[t._v(t._s(t._f("clTime")(a.row.visitTime)))]):t._e()]}}])}),t._v(" "),e("el-table-column",{attrs:{prop:"visitorPersonName",label:"姓名",align:"center","min-width":"120px",sortable:""}}),t._v(" "),e("el-table-column",{attrs:{prop:"faceImageUrl",label:"人脸","min-width":"120",align:"center",sortable:""},scopedSlots:t._u([{key:"default",fn:function(a){return[e("img",{staticStyle:{width:"80px",height:"80px"},attrs:{src:t.imgurl+"/file/download?path="+a.row.faceImageUrl,alt:""}})]}}])}),t._v(" "),e("el-table-column",{attrs:{prop:"phone",label:"手机号",align:"center",sortable:"","min-width":"120"}}),t._v(" "),e("el-table-column",{attrs:{prop:"houseAddress",label:"访问位置","min-width":"120",align:"center",width:"auto",sortable:""}}),t._v(" "),e("el-table-column",{attrs:{prop:"visitPerson",align:"center",label:"被访人","min-width":"120px",sortable:""}}),t._v(" "),e("el-table-column",{attrs:{label:"授权状态",align:"center",width:"120",sortable:""},scopedSlots:t._u([{key:"default",fn:function(a){return[0!=a.row.grantTotalNum&&a.row.grantSuccessNum>=a.row.grantTotalNum?e("div",{staticClass:"grant-box",on:{click:function(e){t.goView(a.row.personId,a.row.visitorPersonName)}}},[e("div",{staticClass:"grant-color-s"}),t._v(" "),e("span",{staticClass:"grant-num-s"},[t._v(t._s(a.row.grantSuccessNum)+"/"+t._s(a.row.grantTotalNum))])]):t._e(),t._v(" "),0!=a.row.grantTotalNum&&0==a.row.grantSuccessNum?e("div",{staticClass:"grant-box",on:{click:function(e){t.goView(a.row.personId,a.row.visitorPersonName)}}},[e("div",{staticClass:"grant-color-f"}),t._v(" "),e("span",{staticClass:"grant-num-f"},[t._v(t._s(a.row.grantSuccessNum)+"/"+t._s(a.row.grantTotalNum))])]):t._e(),t._v(" "),0!=a.row.grantTotalNum&&a.row.grantSuccessNum<a.row.grantTotalNum&&0!=a.row.grantSuccessNum?e("div",{staticClass:"grant-box",on:{click:function(e){t.goView(a.row.personId,a.row.visitorPersonName)}}},[e("div",{staticClass:"grant-color-half"}),t._v(" "),e("span",{staticClass:"grant-num-half"},[t._v(t._s(a.row.grantSuccessNum)+"/"+t._s(a.row.grantTotalNum))])]):t._e()]}}])}),t._v(" "),e("el-table-column",{attrs:{prop:"visitorPassble",align:"center",label:"状态",width:"auto",sortable:""},scopedSlots:t._u([{key:"default",fn:function(a){return[1==a.row.visitorPassble?e("span",[t._v("有效")]):t._e(),t._v(" "),2==a.row.visitorPassble?e("span",[t._v("无效")]):t._e(),t._v(" "),3==a.row.visitorPassble?e("span",[t._v("过期")]):t._e(),t._v(" "),4==a.row.visitorPassble?e("span",[t._v("取消")]):t._e()]}}])}),t._v(" "),e("el-table-column",{attrs:{prop:"name",label:"操作",width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-row",[1==a.row.visitorPassble?e("el-button",{attrs:{title:"取消",type:"danger",icon:"el-icon-delete",round:"",size:"mini"},on:{click:function(e){t.clickDel(a.row.id)}}}):t._e()],1)]}}])})],1),t._v(" "),e("div",{staticClass:"block mt-10"},[e("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[10,15,20,25],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)])]),t._v(" "),e("auth-box",{ref:"authData",attrs:{authPopVisible:t.authPopVisible,authPopTitle:t.authPopTitle},on:{"update:authPopVisible":function(a){t.authPopVisible=a}}}),t._v(" "),e("export-box",{ref:"exportData",attrs:{exportPopVisible:t.outPop,isExport:t.isExport},on:{"update:exportPopVisible":function(a){t.outPop=a},"update:isExport":function(a){t.isExport=a}}}),t._v(" "),e("msg-box",{attrs:{popVisible:t.popVisible,popTitle:t.popTitle,popContent:t.popContent},on:{"update:popVisible":function(a){t.popVisible=a}}})],1)},d=[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("section",{staticClass:"content-header"},[e("h1",{staticClass:"nice"},[t._v("\n      人员管理 - 访客管理\n        ")]),t._v(" "),e("ol",{staticClass:"breadcrumb"},[e("li",[e("a",{attrs:{href:"/"}},[e("i",{staticClass:"glyphicon glyphicon-home"}),t._v(" 首页\n          ")])]),t._v(" "),e("li",[e("i",{staticClass:"glyphicon glyphicon-user"}),t._v(" 人员管理\n        ")]),t._v(" "),e("li",{staticClass:"active"},[e("i",{staticClass:"glyphicon glyphicon-adjust"}),t._v(" 访客管理\n        ")])])])}],h={render:p,staticRenderFns:d},b=h,g=e("VU/8"),m=i,v=g(u,b,!1,m,"data-v-513831b4",null);a.default=v.exports}});