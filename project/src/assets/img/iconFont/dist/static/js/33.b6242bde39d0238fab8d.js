webpackJsonp([33],{PyJ7:function(t,e,a){"use strict";function i(t){a("ZMh2")}Object.defineProperty(e,"__esModule",{value:!0});var s=a("TtmE"),o=a("D7x1"),r=a("pOg+"),l={name:"home",data:function(){return{msg:"通道规则",currentPage:1,popVisible:!0,popTitle:"这个是标题",popContent:"这个是内容",total:0,multipleSelection:[],tableData:[],tableLabel:[{label:"序号",param:"img",align:"center",sortable:!0,isshow:!0,index:!0},{label:"报警时间",param:"createTime",align:"center",sortable:!0,width:"120",isshow:!0},{label:"报警类型",param:"alarmType",align:"center",isshow:!0,width:"120",sortable:!0,render:function(t){return 0==t.alarmType?"无报警":1==t.alarmType?"门未关":2==t.alarmType?"非法开门":3==t.alarmType?"设备拆除":void 0}},{label:"抓拍照片",param:"snapUrl",align:"center",sortable:!0,isimg:!0,isshow:!0,width:"120"},{label:"报警设备",param:"deviceName",align:"center",isshow:!0,width:"120",sortable:!0},{label:"所在位置",param:"area",align:"center",isshow:!0,width:"120",sortable:!0},{slot:"operate",isshow:!0}],statusOptions:[{value:0,label:"无报警"},{value:1,label:"门未关"},{value:2,label:"非法开门"},{value:3,label:"设备拆除"}],value:"",timeArr:[],dataForm:{appId:"",alarmType:"",deviceId:"",startTime:"",endTime:"",pageNum:1,pageSize:10},isShowSelect:!0,deviceGroup:[],deviceForm:{appId:"",page:1,pageSize:1e3},outChecked:!1,outPop:!1,loading:!1,isExport:!1,imgurl:"",recordContentPop:!1,contentMsg:{}}},filters:{},created:function(){this.imgurl=this.tools.global.API_URL},computed:{appId:{get:function(){return this.$store.state.project.projectId},set:function(t){this.$store.commit("changeProjectId",t)}}},watch:{appId:function(t,e){this.appId=t,this.dataForm={appId:t,alarmType:"",deviceId:"",startTime:"",endTime:"",pageNum:1,pageSize:10},this.deviceForm.appId=t,this.getDevice(),this.getToDayTime()}},components:{MsgBox:s.a,TableCmp:o.a,ExportBox:r.a},mounted:function(){this.appId&&(this.dataForm.appId=this.appId,this.deviceForm.appId=this.appId,this.getDevice(),this.getToDayTime())},methods:{getToDayTime:function(){var t=new Date,e=t.getFullYear()+"-",a=(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-",i=(t.getDate()<10?"0"+t.getDate():t.getDate())+" ",s=e+a+i;this.timeArr=[s+"00:00:00",s+"23:59:59"],this.dataForm.startTime=this.timeArr[0],this.dataForm.endTime=this.timeArr[1],this.getTableData()},consoleSelect:function(){console.log(this.$refs.tableChild.selectData)},open:function(){var t=this,e=setTimeout(function(){t.popVisible=!1,clearTimeout(e)},3e3)},getDevice:function(){var t=this;this.utils.http({url:"/device/page",method:"POST",data:this.deviceForm},function(e){200==e.code&&(t.deviceGroup=e.data.records)})},getTableData:function(){var t=this;this.loading=!0,this.utils.http({url:"/record/alarm/page",method:"POST",data:this.dataForm},function(e){t.loading=!1,200==e.code&&(t.total=e.data.total,t.tableData=e.data.records,t.currentPage=e.data.current)})},resetBtn:function(){this.dataForm={appId:this.appId,alarmType:"",deviceId:"",startTime:"",endTime:"",pageNum:1,pageSize:10},this.getToDayTime()},handleSelectionChange:function(t){this.multipleSelection=t,console.log(this.multipleSelection)},handleSizeChange:function(t){this.dataForm.pageSize=t,this.getTableData()},handleCurrentChange:function(t){this.dataForm.pageNum=t,this.getTableData()},changeTime:function(t){null!==this.timeArr&&this.timeArr.length>0?(this.dataForm.startTime=this.timeArr[0],this.dataForm.endTime=this.timeArr[1]):(this.dataForm.startTime="",this.dataForm.endTime="")},exportBtn:function(){this.outPop=!0},outBtn:function(){var t=this;this.isExport=!0,this.outChecked=this.$refs.exportData.outChecked,this.outChecked?this.dataForm.withPic=1:this.dataForm.withPic=0;var e=[];this.$refs.tableChild.selectData.forEach(function(t,a){e.push(t.id)}),this.dataForm.ids=e,this.utils.http({url:"/record/alarm/export",method:"POST",data:this.dataForm},function(e){t.isExport=!1,t.outPop=!1,delete t.dataForm.ids,200==e.code?t.$alert("记录正在导出请稍后","提示",{confirmButtonText:"确定",dangerouslyUseHTMLString:!0,closeOnClickModal:!0,type:"success"}).then(function(){}).catch(function(){}):t.$alert("记录导出失败","提示",{confirmButtonText:"确定",dangerouslyUseHTMLString:!0,closeOnClickModal:!0,type:"error"}).then(function(){}).catch(function(){})})},seeContent:function(t){this.contentMsg=t,this.recordContentPop=!0}}},n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content-wrapper"},[t._m(0),t._v(" "),a("section",{staticClass:"content container-fluid"},[a("div",{staticClass:"box box-primary"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"box-body"},[a("div",{staticClass:"form-horizontal"},[a("div",{staticClass:"col-lg-4 pl-0"},[a("div",{staticClass:"form-group"},[a("div",{staticClass:"col-md-12"},[a("el-date-picker",{attrs:{clearable:"",small:"small",align:"right",type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:t.changeTime},model:{value:t.timeArr,callback:function(e){t.timeArr=e},expression:"timeArr"}})],1)])]),t._v(" "),a("div",{staticClass:"col-lg-2"},[a("div",{staticClass:"form-group"},[a("div",{staticClass:"col-md-12"},[a("el-select",{attrs:{clearable:"",placeholder:"选择报警类型"},model:{value:t.dataForm.alarmType,callback:function(e){t.$set(t.dataForm,"alarmType",e)},expression:"dataForm.alarmType"}},t._l(t.statusOptions,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)])]),t._v(" "),a("div",{staticClass:"col-lg-2"},[a("div",{staticClass:"form-group"},[a("div",{staticClass:"col-md-12"},[a("el-select",{attrs:{clearable:"",placeholder:"选择报警设备"},model:{value:t.dataForm.deviceId,callback:function(e){t.$set(t.dataForm,"deviceId",e)},expression:"dataForm.deviceId"}},t._l(t.deviceGroup,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1)])]),t._v(" "),a("div",{staticClass:"col-lg-3  pr-0"},[a("div",{staticClass:"btn-group"},[a("button",{staticClass:"btn btn-primary",attrs:{id:"btn_device_search",type:"button"},on:{click:t.getTableData}},[a("span",{staticClass:"glyphicon glyphicon-search",attrs:{"aria-hidden":"true"}}),t._v("查询\n                        ")]),t._v(" "),a("button",{staticClass:"btn btn-default",attrs:{id:"btn_device_reset",type:"button"},on:{click:t.resetBtn}},[a("span",{staticClass:"fa fa-reply",attrs:{"aria-hidden":"true"}}),t._v("重置\n                        ")])])])]),t._v(" "),a("div",{staticClass:" btn-group-box",staticStyle:{width:"100%"},attrs:{id:"toolbar"}},[a("div",{staticClass:"btn-group",attrs:{"data-toggle":"buttons"}},[a("button",{staticClass:"btn btn-default",attrs:{id:"btn_delete",type:"button"},on:{click:t.exportBtn}},[a("span",{staticClass:"glyphicon glyphicon-arrow-down",attrs:{"aria-hidden":"true"}}),t._v("导出\n                      ")])])]),t._v(" "),a("table-cmp",{ref:"tableChild",attrs:{"table-data":t.tableData,"table-label":t.tableLabel,"is-show-select":t.isShowSelect}}),t._v(" "),a("div",{staticClass:"block mt-10"},[a("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[10,15,20,25],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)])]),t._v(" "),a("export-box",{ref:"exportData",attrs:{exportPopVisible:t.outPop,isExport:t.isExport},on:{"update:exportPopVisible":function(e){t.outPop=e},"update:isExport":function(e){t.isExport=e}}})],1)},c=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"content-header"},[a("h1",{staticClass:"nice"},[t._v("\n      报警管理 - 报警记录\n        ")]),t._v(" "),a("ol",{staticClass:"breadcrumb"},[a("li",[a("a",{attrs:{href:"/"}},[a("i",{staticClass:"glyphicon glyphicon-home"}),t._v(" 首页\n          ")])]),t._v(" "),a("li",[a("i",{staticClass:"glyphicon glyphicon-time"}),t._v(" 报警管理\n        ")]),t._v(" "),a("li",{staticClass:"active"},[a("i",{staticClass:"glyphicon glyphicon-adjust"}),t._v(" 报警记录\n        ")])])])}],d={render:n,staticRenderFns:c},p=d,h=a("VU/8"),u=i,m=h(l,p,!1,u,"data-v-05ee87bd",null);e.default=m.exports},ZMh2:function(t,e,a){var i=a("iTfg");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("555e0791",i,!0)},iTfg:function(t,e,a){e=t.exports=a("FZ+f")(!1),e.push([t.i,"\n#charts[data-v-05ee87bd]{height:300px\n}\n",""])}});