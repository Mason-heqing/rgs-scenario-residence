webpackJsonp([20],{Z7CW:function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,"\n.add-h4[data-v-2865c634]{padding-left:10px;margin-left:20px;border-left:5px solid #007aff\n}\n.avatar-uploader .el-upload[data-v-2865c634]{border:1px dashed #d9d9d9;border-radius:6px;cursor:pointer;position:relative;overflow:hidden\n}\n.avatar-uploader .el-upload[data-v-2865c634]:hover{border-color:#409EFF\n}\n.avatar-uploader-icon[data-v-2865c634]{font-size:28px;color:#8c939d;width:148px;height:148px;line-height:148px;text-align:center;border:1px dashed #c0ccda\n}\n.avatar[data-v-2865c634]{width:148px;height:148px;display:block\n}\n.el-cascader[data-v-2865c634]{width:100%\n}\n.upload_box[data-v-2865c634] .el-upload{width:150px;height:150px;border-radius:2px;border:1px solid #9e9da2;text-align:center;line-height:150px\n}\n.upload_box[data-v-2865c634] .el-upload-dragger{width:148px;height:148px;border:0\n}\n",""])},qi7x:function(e,t,a){var s=a("Z7CW");"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);a("rjj0")("95c47f04",s,!0)},zvCp:function(e,t,a){"use strict";function s(e){a("qi7x")}Object.defineProperty(t,"__esModule",{value:!0});var i=(a("XLwt"),{name:"home",data:function(){return{msg:"项目管理",addPeople:{appId:"",personName:"",deviceGroupList:[],department:"",idCard:"",post:"",effectiveStatus:!0,faceUrl:"",groupId:"",icNum:"",id:"",idNum:"",job:"",name:"",phone:""},imgurl:"",rules:{personName:[{required:!0,message:"请输入员工姓名",trigger:"blur"}],groupId:[{required:!0,message:"请选择所属部门",trigger:"change"}],phone:[{validator:function(e,t,a){t?/^1(3|4|5|6|7|8|9)\d{9}$/.test(t)?a():a(new Error("请输入正确的手机号")):a()},trigger:"blur"}]},images:[],uploadData:{appId:""},groupData:[],groupProps:{children:"groupList",label:"title",value:"id",checkStrictly:!0,expandTrigger:"hover"},groupType:[{name:"第一个选项",id:"3"},{name:"第二个选项",id:"1"},{name:"第三个选项",id:"2"}],imageUrl:"",addPop:!0,groupName:"",startTime:null,options:[],value:!0,data:[],defaultProps:{children:"groupList",label:"title",value:"id"},personId:"",checkArr:[],editOrAdd:"添加",isRequst:!1}},computed:{appId:{get:function(){return this.$store.state.project.projectId},set:function(e){this.$store.commit("changeProjectId",e)}}},watch:{appId:function(e,t){this.appId=e,this.addPeople.appId=e,this.uploadData.appId=e,this.getGroup(),this.getBuildingUnit()}},filters:{},created:function(){this.imgurl=this.tools.global.API_URL,this.addPeople.appId=this.appId,this.uploadData.appId=this.appId},mounted:function(){this.getGroup(),2==this.$route.query.type?(this.addPeople=JSON.parse(this.utils.getStore("staffMsg")),this.personId=this.addPeople.id,this.addPeople.deviceGroupList=this.addPeople.deviceGroupList,this.getBuildingUnit(),this.editOrAdd="更新",this.addPeople.faceUrl&&(this.images=this.addPeople.faceUrl.split(","))):this.getBuildingUnit()},methods:{elCascaderOnlick:function(){var e=this;setTimeout(function(){document.querySelectorAll(".el-cascader-node__label").forEach(function(t){t.onclick=function(){this.previousElementSibling.click(),e.$refs.elcascader.dropDownVisible=!1}}),document.querySelectorAll(".el-cascader-panel .el-radio").forEach(function(t){t.onclick=function(){e.$refs.elcascader.dropDownVisible=!1}})},100)},getBuildingUnit:function(){var e=this;this.utils.http({url:"/person/group/queryResidenceBuildingUnit",method:"GET",params:{appId:this.appId,personId:this.personId}},function(t){200==t.code&&(e.data=t.data,e.getCheckBuild(t.data))})},getCheckBuild:function(e){for(var t=0;t<e.length;t++)e[t].checkStatus&&this.checkArr.push(e[t].id),e[t].groupList&&this.getTreeData(e[t].groupList);console.log(this.checkArr)},checkChange:function(){this.addPeople.deviceGroupList=this.$refs.tree.getCheckedKeys(),console.log(this.addPeople.deviceGroupList)},addBtn:function(e){var t=this;this.addPeople.effectiveStatus?this.addPeople.effectiveStatus="1":this.addPeople.effectiveStatus="0",this.$refs[e].validate(function(e){e&&(t.isRequst=!0,t.addPeople.faceUrl=t.images.join(),t.utils.http({url:"/person/group/addEmployee",method:"POST",data:t.addPeople},function(e){console.log(e),t.isRequst=!1,"200"==e.code&&t.$router.push({path:"/staffmanage"})}))})},handleNodeClick:function(e,t,a){this.selectGroup=e.label,console.log(e),console.log(t),console.log(a)},getGroup:function(){var e=this;this.utils.http({url:"/person/group/queryPersonGroupVoList",method:"GET",params:{appId:this.appId}},function(t){200==t.code&&(console.log(t.data),e.groupData=e.getTreeData(t.data))})},getTreeData:function(e){for(var t=0;t<e.length;t++)e[t].groupList.length<1?e[t].groupList=void 0:this.getTreeData(e[t].groupList);return e},handleChange:function(e){this.addPeople.groupId=e[e.length-1]},beforeAvatarUpload:function(e){var t=["image/jpeg","image/jpg","image/png","image/bmp"],a=t.includes(e.type),s=e.size/1024/1024<5;return console.log(e.size),a?s?void 0:(this.$message.error("上传图片大小不能超过 5MB!"),!1):(this.$message.error("格式不支持"),!1)},successCheck:function(e,t,a){var s=this;console.log(e),200==e.code?this.images.length<1?e.data.forEach(function(e,t){s.images.push(e)}):this.utils.tip("warning","文件个数超出"):this.$message.error(e.msg)},uploadErr:function(e,t,a){this.$message.error("上传失败")},goBack:function(){this.$router.push({path:"/staffmanage"})},remove:function(e){this.images.splice(e,1)},changeType:function(){},changeTime:function(e){console.log(e)},handleCheckedCitiesChange:function(e){console.log(e)}}}),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"content-wrapper"},[e._m(0),e._v(" "),a("section",{staticClass:"content container-fluid"},[a("div",{staticClass:"panel-body",staticStyle:{padding:"0"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-12"},[a("div",{staticClass:"box box-primary"},[a("div",{staticClass:"box-header with-border"},[a("h3",{staticClass:"box-title"},[e._v(e._s(e.editOrAdd))])]),e._v(" "),a("div",{staticClass:"row"},[a("div",{staticClass:"col-lg-6 col-md-12"},[a("h4",{staticClass:"add-h4"},[e._v("基础信息")]),e._v(" "),a("el-form",{ref:"addPeople",staticStyle:{"padding-bottom":"30px"},attrs:{model:e.addPeople,rules:e.rules}},[a("div",{staticClass:"row"},[a("label",{staticClass:"col-sm-3 control-label text-right",attrs:{for:"name"}},[a("span",{staticStyle:{color:"red","line-height":"40px"}},[e._v("*")]),e._v("\n                      员工姓名\n                    ")]),e._v(" "),a("div",{staticClass:"col-sm-7"},[a("el-form-item",{attrs:{prop:"personName"}},[a("el-input",{attrs:{placeholder:"输入员工姓名最大支持20字",maxlength:20},model:{value:e.addPeople.personName,callback:function(t){e.$set(e.addPeople,"personName",t)},expression:"addPeople.personName"}})],1)],1),e._v(" "),a("div",{staticClass:"col-sm-2",staticStyle:{"line-height":"34px",color:"red"}})]),e._v(" "),a("div",{staticClass:"row"},[a("label",{staticClass:"col-sm-3 control-label text-right",attrs:{for:"name"}},[a("span",{staticStyle:{color:"red","line-height":"40px"}},[e._v("*")]),e._v("\n                      所属部门\n                    ")]),e._v(" "),a("div",{staticClass:"col-sm-7"},[a("el-form-item",{attrs:{prop:"groupId"}},[a("el-cascader",{ref:"elcascader",attrs:{props:e.groupProps,options:e.groupData},on:{change:e.handleChange,"visible-change":e.elCascaderOnlick,"expand-change":e.elCascaderOnlick},model:{value:e.addPeople.groupId,callback:function(t){e.$set(e.addPeople,"groupId",t)},expression:"addPeople.groupId"}})],1)],1)]),e._v(" "),a("div",{staticClass:"row"},[a("label",{staticClass:"col-sm-3 control-label text-right",attrs:{for:"name"}},[a("span",{staticStyle:{color:"red","line-height":"40px"}}),e._v("\n                      身份证号\n                    ")]),e._v(" "),a("div",{staticClass:"col-sm-7"},[a("el-form-item",[a("el-input",{attrs:{placeholder:"输入员工身份证号",maxlength:"18"},model:{value:e.addPeople.idNum,callback:function(t){e.$set(e.addPeople,"idNum",t)},expression:"addPeople.idNum"}})],1)],1),e._v(" "),a("div",{staticClass:"col-sm-2",staticStyle:{"line-height":"34px",color:"red"}})]),e._v(" "),a("div",{staticClass:"row"},[a("label",{staticClass:"col-sm-3 control-label text-right",attrs:{for:"name"}},[a("span",{staticStyle:{color:"red","line-height":"40px"}}),e._v("\n                      联系方式\n                    ")]),e._v(" "),a("div",{staticClass:"col-sm-7"},[a("el-form-item",{attrs:{prop:"phone"}},[a("el-input",{attrs:{placeholder:"输入员工手机号码最大支持11字",maxlength:11},model:{value:e.addPeople.phone,callback:function(t){e.$set(e.addPeople,"phone",t)},expression:"addPeople.phone"}})],1)],1),e._v(" "),a("div",{staticClass:"col-sm-2",staticStyle:{"line-height":"34px",color:"red"}})]),e._v(" "),a("div",{staticClass:"row"},[a("label",{staticClass:"col-sm-3 control-label text-right",attrs:{for:"name"}},[a("span",{staticStyle:{color:"red","line-height":"40px"}}),e._v("\n                      所属岗位\n                    ")]),e._v(" "),a("div",{staticClass:"col-sm-7"},[a("el-form-item",[a("el-input",{attrs:{placeholder:"输入员工岗位最大支持20字",maxlength:20},model:{value:e.addPeople.job,callback:function(t){e.$set(e.addPeople,"job",t)},expression:"addPeople.job"}})],1)],1),e._v(" "),a("div",{staticClass:"col-sm-2",staticStyle:{"line-height":"34px",color:"red"}})]),e._v(" "),a("h4",{staticClass:"add-h4"},[e._v("通行凭证")]),e._v(" "),a("div",{staticClass:"row"},[a("label",{staticClass:"col-sm-3 control-label text-right",attrs:{for:"name"}},[a("span",{staticStyle:{color:"red","line-height":"40px"}}),e._v("\n                      人脸头像\n                    ")]),e._v(" "),a("div",{staticClass:"col-sm-7"},[a("div",{staticClass:"upload_box"},[0==e.images.length?a("el-upload",{attrs:{drag:"",name:"file","with-credentials":!0,"show-file-list":!1,action:e.imgurl+"/file/person/upload","list-type":"picture-card",data:e.uploadData,"on-success":e.successCheck,"before-upload":e.beforeAvatarUpload,"on-error":e.uploadErr}},[a("span",{staticStyle:{color:"#9E9DA2","font-size":"12px"}},[e._v("+添加图片")])]):a("ul",{staticClass:"el-upload-list el-upload-list--picture-card"},e._l(e.images,function(t,s){return a("li",{key:s,staticClass:"el-upload-list__item is-success animated",attrs:{tabindex:s}},[a("img",{staticClass:"el-upload-list__item-thumbnail",attrs:{src:e.imgurl+"/file/download?path="+t,alt:""}}),e._v(" "),a("a",{staticClass:"el-upload-list__item-name"},[a("i",{staticClass:"el-icon-document"}),e._v("\n                              "+e._s(t.name)+"\n                            ")]),e._v(" "),a("label",{staticClass:"el-upload-list__item-status-label"},[a("i",{staticClass:"el-icon-upload-success el-icon-check"})]),e._v(" "),a("span",{staticClass:"el-upload-list__item-actions"},[a("span",{staticClass:"el-upload-list__item-delete"},[a("i",{staticClass:"el-icon-delete",on:{click:function(t){e.remove(s)}}})])])])}))],1)])]),e._v(" "),a("div",{staticClass:"row mt-20"},[a("label",{staticClass:"col-sm-3 control-label text-right",attrs:{for:"name"}},[a("span",{staticStyle:{color:"red","line-height":"40px"}}),e._v("\n                      IC卡片\n                    ")]),e._v(" "),a("div",{staticClass:"col-sm-7"},[a("el-form-item",[a("el-input",{attrs:{placeholder:"输入IC卡号"},model:{value:e.addPeople.icNum,callback:function(t){e.$set(e.addPeople,"icNum",t)},expression:"addPeople.icNum"}})],1)],1),e._v(" "),a("div",{staticClass:"col-sm-2",staticStyle:{"line-height":"34px",color:"red"}})]),e._v(" "),a("div",{staticClass:"row"},[a("label",{staticClass:"col-sm-3 control-label text-right",attrs:{for:"name"}},[a("span",{staticStyle:{color:"red","line-height":"40px"}}),e._v("\n                      启用状态\n                    ")]),e._v(" "),a("div",{staticClass:"col-sm-7"},[a("el-form-item",[a("el-switch",{attrs:{"active-color":"#13ce66"},model:{value:e.addPeople.effectiveStatus,callback:function(t){e.$set(e.addPeople,"effectiveStatus",t)},expression:"addPeople.effectiveStatus"}})],1)],1),e._v(" "),a("div",{staticClass:"col-sm-2",staticStyle:{"line-height":"34px",color:"red"}})])])],1),e._v(" "),a("div",{staticClass:"col-lg-6 col-md-12"},[a("h4",{staticClass:"add-h4"},[e._v("通行权限")]),e._v(" "),a("div",{staticClass:"row"},[a("div",{staticClass:"col-sm-1"}),e._v(" "),a("div",{staticClass:"col-sm-8",staticStyle:{"overflow-x":"hidden","overflow-y":"auto","max-height":"600px"}},[a("el-tree",{ref:"tree",attrs:{data:e.data,"show-checkbox":"","node-key":"id","default-expand-all":"",props:e.defaultProps,"highlight-current":!0,"expand-on-click-node":!1,"default-checked-keys":e.addPeople.deviceGroupList},on:{"node-click":e.handleNodeClick,"check-change":e.checkChange}})],1)])])]),e._v(" "),a("div",{staticClass:"col-lg-12"},[a("div",{staticClass:"form-group text-center pb-40"},[e.isRequst?a("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[e._v("保存中")]):a("button",{staticClass:"btn btn-primary",attrs:{type:"submit"},on:{click:function(t){e.addBtn("addPeople")}}},[e._v("保存")]),e._v(" "),a("button",{staticClass:"btn btn-default",attrs:{type:"button",id:"btn-back"},on:{click:e.goBack}},[e._v("返回")])])])])])])])])])},o=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"content-header"},[a("h1",{staticClass:"nice"},[e._v("\n      人员管理 - 添加员工\n      ")]),e._v(" "),a("ol",{staticClass:"breadcrumb"},[a("li",[a("a",{attrs:{href:"/"}},[a("i",{staticClass:"glyphicon glyphicon-home"}),e._v(" 首页\n        ")])]),e._v(" "),a("li",[a("i",{staticClass:"glyphicon glyphicon-user"}),e._v(" 人员管理\n      ")]),e._v(" "),a("li",{staticClass:"active"},[a("i",{staticClass:"glyphicon glyphicon-adjust"}),e._v(" 添加员工\n      ")])])])}],c={render:l,staticRenderFns:o},r=c,d=a("VU/8"),n=s,p=d(i,r,!1,n,"data-v-2865c634",null);t.default=p.exports}});