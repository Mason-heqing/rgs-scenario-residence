webpackJsonp([31],{edtm:function(t,e,a){e=t.exports=a("FZ+f")(!1),e.push([t.i,"\n.form-horizontal[data-v-610c36d6] .el-range-editor.el-input__inner{width:100%\n}\n.form-horizontal[data-v-610c36d6] .content .el-input__icon{line-height:26px\n}\n.form-horizontal[data-v-610c36d6] .el-date-editor .el-range-separator{line-height:26px\n}\n",""])},htQU:function(t,e,a){"use strict";function i(t){a("t7XE")}Object.defineProperty(e,"__esModule",{value:!0});var o=a("TtmE"),s=a("D7x1"),r=a("pOg+"),l={name:"home",data:function(){return{msg:"通道规则",currentPage:1,popVisible:!0,popTitle:"这个是标题",popContent:"这个是内容",total:0,multipleSelection:[],tableData:[],tableLabel:[{label:"抓拍照片",param:"pictureUrl",align:"center",sortable:!0,isimg:!0,isshow:!0,width:"120"},{label:"呼叫设备",param:"deviceName",align:"center",sortable:!0,isshow:!0,width:"120"},{label:"呼叫户室",param:"houseName",align:"center",isshow:!0,width:"120",sortable:!0},{label:"发起时间",param:"callStartTime",align:"center",sortable:!0,isshow:!0,width:"150"},{label:"接通状态",param:"throughStatus",align:"center",isshow:!0,width:"120",sortable:!0,render:function(t){return 1==t.throughStatus?"已接通":0==t.throughStatus?"未接通":void 0}},{label:"开门状态",param:"openStatus",align:"center",isshow:!0,width:"120",sortable:!0,render:function(t){return 0==t.openStatus?"未开门":1==t.openStatus?"开门成功":2==t.openStatus?"开门失败":void 0}}],throughStatusOption:[{value:1,label:"已接通"},{value:0,label:"未接通"}],openStatusOption:[{value:0,label:"未开门"},{value:1,label:"开门成功"},{value:2,label:"开门失败"}],value:"",timeArr:[],isShowSelect:!0,dataForm:{appId:"",throughStatus:"",houseId:"",deviceId:"",openStatus:null,startTime:"",endTime:"",pageNum:1,pageSize:10},deviceForm:{appId:"",page:1,pageSize:1e3},deviceGroup:[],contentMsg:{},recordContentPop:!1,imgurl:"",outChecked:!1,outPop:!1,isExport:!1,cascaderKey:1,cascaderData:[],groupProps:{children:"groups",label:"name",value:"id",checkStrictly:!0,expandTrigger:"hover"}}},computed:{appId:{get:function(){return this.$store.state.project.projectId},set:function(t){this.$store.commit("changeProjectId",t)}}},watch:{appId:function(t,e){this.appId=t,this.dataForm={appId:t,throughStatus:"",houseId:"",deviceId:"",openStatus:null,startTime:"",endTime:"",pageNum:1,pageSize:10},++this.cascaderKey,this.deviceForm.appId=t,this.getDevice(),this.getLeftData(),this.getToDayTime()}},filters:{},created:function(){this.imgurl=this.tools.global.API_URL},components:{MsgBox:o.a,TableCmp:s.a,ExportBox:r.a},mounted:function(){this.appId&&(this.deviceForm.appId=this.appId,this.dataForm.appId=this.appId,this.getDevice(),this.getLeftData(),this.getToDayTime())},methods:{getToDayTime:function(){var t=new Date,e=t.getFullYear()+"-",a=(t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1)+"-",i=(t.getDate()<10?"0"+t.getDate():t.getDate())+" ",o=e+a+i;this.timeArr=[o+"00:00:00",o+"23:59:59"],this.dataForm.startTime=this.timeArr[0],this.dataForm.endTime=this.timeArr[1],this.getTableData()},elCascaderOnlick:function(){var t=this;setTimeout(function(){document.querySelectorAll(".el-cascader-node__label").forEach(function(e){e.onclick=function(){this.previousElementSibling.click(),t.$refs.elcascader.dropDownVisible=!1}}),document.querySelectorAll(".el-cascader-panel .el-radio").forEach(function(e){e.onclick=function(){t.$refs.elcascader.dropDownVisible=!1}})},100)},cascaderChange:function(t){t&&(this.dataForm.houseId=t[t.length-1])},getLeftData:function(){var t=this;this.utils.http({url:"/base/house/list",method:"GET",params:{appId:this.appId}},function(e){200==e.code&&e.data&&(t.cascaderData=e.data.groups)})},getDevice:function(){var t=this;this.utils.http({url:"/device/page",method:"POST",data:this.deviceForm},function(e){200==e.code&&(t.deviceGroup=e.data.records)})},getTableData:function(){var t=this;this.loading=!0,this.utils.http({url:"/record/intercom/pageAll",method:"POST",data:this.dataForm},function(e){t.loading=!1,200==e.code&&(t.total=e.data.total,t.tableData=e.data.records,t.currentPage=e.data.current)})},resetBtn:function(){this.dataForm={appId:this.appId,throughStatus:"",houseId:"",deviceId:"",openStatus:null,startTime:"",endTime:"",pageNum:1,pageSize:10},this.getToDayTime()},handleSelectionChange:function(t){this.multipleSelection=t,console.log(this.multipleSelection)},handleSizeChange:function(t){this.dataForm.pageSize=t,this.getTableData()},handleCurrentChange:function(t){this.dataForm.pageNum=t,this.getTableData()},changeTime:function(t){null!==this.timeArr&&this.timeArr.length>0?(this.dataForm.startTime=this.timeArr[0],this.dataForm.endTime=this.timeArr[1]):(this.dataForm.startTime="",this.dataForm.endTime="")},exportBtn:function(){this.outPop=!0},outBtn:function(){var t=this;this.isExport=!0,this.outChecked=this.$refs.exportData.outChecked,this.outChecked?this.dataForm.withPic=1:this.dataForm.withPic=0;var e=[];this.$refs.tableChild.selectData.forEach(function(t,a){e.push(t.id)}),this.dataForm.ids=e,this.utils.http({url:"/record/intercom/export",method:"POST",data:this.dataForm},function(e){t.isExport=!1,t.outPop=!1,delete t.dataForm.ids,200==e.code?t.$alert("记录正在导出请稍后","提示",{confirmButtonText:"确定",cancelButtonText:"取消",dangerouslyUseHTMLString:!0,closeOnClickModal:!0,type:"success"}).then(function(){}).catch(function(){}):t.$alert("记录导出失败","提示",{confirmButtonText:"确定",cancelButtonText:"取消",dangerouslyUseHTMLString:!0,closeOnClickModal:!0,type:"error"}).then(function(){}).catch(function(){})})},seeContent:function(t){this.contentMsg=t,this.recordContentPop=!0}}},n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content-wrapper"},[t._m(0),t._v(" "),a("section",{staticClass:"content container-fluid"},[a("div",{staticClass:"box box-primary"},[a("div",{staticClass:"box-body"},[a("div",{staticClass:"form-horizontal"},[a("el-row",{staticStyle:{display:"block"},attrs:{gutter:10}},[a("el-col",{staticClass:"mb-15",attrs:{lg:4,xl:4}},[a("el-cascader",{key:t.cascaderKey,ref:"elcascader",staticStyle:{width:"100%"},attrs:{clearable:"",placeholder:"楼栋/单元/房间",options:t.cascaderData,props:t.groupProps},on:{"visible-change":t.elCascaderOnlick,"expand-change":t.elCascaderOnlick,change:t.cascaderChange},model:{value:t.dataForm.houseId,callback:function(e){t.$set(t.dataForm,"houseId",e)},expression:"dataForm.houseId"}})],1),t._v(" "),a("el-col",{staticClass:"mb-15",attrs:{lg:6,xl:6}},[a("el-date-picker",{attrs:{clearable:"",small:"small",align:"right",type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["00:00:00","23:59:59"]},on:{change:t.changeTime},model:{value:t.timeArr,callback:function(e){t.timeArr=e},expression:"timeArr"}})],1),t._v(" "),a("el-col",{staticClass:"mb-15",attrs:{lg:4,xl:4}},[a("el-select",{attrs:{clearable:"",placeholder:"呼叫设备"},model:{value:t.dataForm.deviceId,callback:function(e){t.$set(t.dataForm,"deviceId",e)},expression:"dataForm.deviceId"}},t._l(t.deviceGroup,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),a("el-col",{staticClass:"mb-15",attrs:{lg:3,xl:3}},[a("el-select",{attrs:{clearable:"",placeholder:"是否接通"},model:{value:t.dataForm.throughStatus,callback:function(e){t.$set(t.dataForm,"throughStatus",e)},expression:"dataForm.throughStatus"}},t._l(t.throughStatusOption,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-col",{staticClass:"mb-15",attrs:{lg:3,xl:3}},[a("el-select",{attrs:{clearable:"",placeholder:"是否开门"},model:{value:t.dataForm.openStatus,callback:function(e){t.$set(t.dataForm,"openStatus",e)},expression:"dataForm.openStatus"}},t._l(t.openStatusOption,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-col",{attrs:{lg:4,xl:4}},[a("div",{staticClass:"btn-group pl-0"},[a("button",{staticClass:"btn btn-primary pl-8 pr-8",attrs:{id:"btn_device_search",type:"button"},on:{click:t.getTableData}},[a("span",{staticClass:"glyphicon glyphicon-search",attrs:{"aria-hidden":"true"}}),t._v("查询\n                ")]),t._v(" "),a("button",{staticClass:"btn btn-default pl-8 pr-8",attrs:{id:"btn_device_reset",type:"button"},on:{click:t.resetBtn}},[a("span",{staticClass:"fa fa-reply",attrs:{"aria-hidden":"true"}}),t._v("重置\n                ")])])])],1),t._v(" "),a("div",{staticClass:"btn-group-box",staticStyle:{width:"100%"},attrs:{id:"toolbar"}},[a("div",{staticClass:"btn-group",attrs:{"data-toggle":"buttons"}},[a("button",{staticClass:"btn btn-default",attrs:{id:"btn_delete",type:"button"},on:{click:t.exportBtn}},[a("span",{staticClass:"glyphicon glyphicon-arrow-down",attrs:{"aria-hidden":"true"}}),t._v("导出\n              ")])])])],1),t._v(" "),a("table-cmp",{ref:"tableChild",attrs:{"table-data":t.tableData,"table-label":t.tableLabel,"is-show-select":t.isShowSelect}}),t._v(" "),a("div",{staticClass:"block mt-10"},[a("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[10,15,20,25],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)])]),t._v(" "),a("export-box",{ref:"exportData",attrs:{exportPopVisible:t.outPop,isExport:t.isExport},on:{"update:exportPopVisible":function(e){t.outPop=e},"update:isExport":function(e){t.isExport=e}}})],1)},c=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"content-header"},[a("h1",{staticClass:"nice"},[t._v("\n      历史记录 - 对讲记录\n      ")]),t._v(" "),a("ol",{staticClass:"breadcrumb"},[a("li",[a("a",{attrs:{href:"/"}},[a("i",{staticClass:"fa fa-home"}),t._v(" 首页\n        ")])]),t._v(" "),a("li",[a("i",{staticClass:"glyphicon glyphicon-dashboard"}),t._v(" 历史记录\n      ")]),t._v(" "),a("li",{staticClass:"active"},[a("i",{staticClass:"glyphicon glyphicon-adjust"}),t._v(" 对讲记录\n      ")])])])}],d={render:n,staticRenderFns:c},u=d,h=a("VU/8"),p=i,m=h(l,u,!1,p,"data-v-610c36d6",null);e.default=m.exports},t7XE:function(t,e,a){var i=a("edtm");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("c9449518",i,!0)}});