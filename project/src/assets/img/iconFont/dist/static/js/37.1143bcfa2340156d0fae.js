webpackJsonp([37],{BNvc:function(t,e,a){"use strict";function i(t){a("ecAN")}Object.defineProperty(e,"__esModule",{value:!0});var l=a("TtmE"),s=a("D7x1"),o={name:"home",data:function(){return{currentPage:1,popVisible:!1,popTitle:"这个是标题",popContent:"这个是内容",total:0,multipleSelection:[],tableData:[],tableLabel:[{label:"软件名称",param:"name",align:"center",sortable:!0,isshow:!0,width:"220"},{label:"软件类型",param:"type",align:"center",width:"120",sortable:!0,isshow:!0,render:function(t){return 1==t.type?"未知":2==t.type?"人脸门禁终端":3==t.type?"人证核验终端":5==t.type?"安卓":void 0}},{label:"软件版本",param:"version",align:"center",sortable:!0,isshow:!0,width:"120"},{label:"软件大小",param:"fileSize",align:"center",sortable:!0,isshow:!0,width:"120",render:function(t){return(t.fileSize/1024/1024).toFixed(2)+"MB"}},{label:"发布时间",param:"createTime",align:"center",sortable:!0,isshow:!0,width:"160"},{label:"上传时间",param:"updateTime",align:"center",sortable:!0,isshow:!0,width:"160"},{label:"类型",param:"type",align:"center",sortable:!0,isshow:!1,width:"100"},{label:"备注信息",param:"remark",align:"center",sortable:!0,isshow:!0,width:"200"},{label:"渠道名称",param:"channel",align:"center",sortable:!0,isshow:!0,width:"120"},{slot:"operate",isshow:!0}],tableOption:[],tableSelect:[],loading:!1,isShowSelect:!0,url:"",isRequst:!1,imgurl:"",softForm:{appId:"",pageSize:10,pageNum:1,search:""},softData:[],fileList:[],uploadData:{appId:""},uploadSoftPop:!1,timer:null,exportUrl:"",isUpload:!1}},computed:{appId:{get:function(){return this.$store.state.project.projectId},set:function(t){this.$store.commit("changeProjectId",t)}}},watch:{appId:function(t,e){this.appId=t,this.softForm={appId:t,pageSize:10,pageNum:1,search:""},this.uploadData.appId=t,this.getDataTable()}},filters:{},created:function(){for(var t=0;t<this.tableLabel.length;t++)this.tableLabel[t].label&&this.tableOption.push(this.tableLabel[t].label),this.tableLabel[t].isshow&&this.tableSelect.push(this.tableLabel[t].label);this.imgurl=this.tools.global.API_URL},components:{MsgBox:l.a,TableCmp:s.a},mounted:function(){this.exportUrl=this.imgurl+"/device/firmware/upload/",this.appId&&(this.softForm.appId=this.appId,this.uploadData.appId=this.appId,this.getDataTable())},methods:{checkboxChange:function(t){for(var e=0;e<this.tableLabel.length;e++)this.tableSelect.indexOf(this.tableLabel[e].label)>-1?this.tableLabel[e].isshow=!0:this.tableLabel[e].isshow=!1},getDataTable:function(){var t=this;this.loading=!0,this.utils.http({url:"/device/firmware/searchDeviceFirmByPage",method:"POST",data:this.softForm},function(e){t.loading=!1,200==e.code&&(t.total=e.data.total,t.tableData=e.data.records,t.currentPage=e.data.current)})},deleteSoft:function(t){var e=this,a=[t];this.$confirm("您确信删除当前软件?","确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.utils.http({url:"/device/firmware/delete",method:"POST",data:{ids:a}},function(t){200==t.code&&(e.utils.tip("success","删除成功"),e.getDataTable())})}).catch(function(){})},handleSizeChange:function(t){this.softForm.pageSize=t,this.getDataTable()},handleCurrentChange:function(t){this.softForm.pageNum=t,this.getDataTable()},open:function(){var t=this;this.timer=setTimeout(function(){t.popVisible=!1,clearTimeout(t.timer)},3e3)},clearSetTimeOut:function(){clearTimeout(this.timer)},submitUpload:function(){this.fileList.length>0?(this.$refs.upload.submit(),this.isUpload=!0):this.$message.error("请选择文件")},abortUpLoad:function(){this.$refs.upload.abort(),this.isUpload=!1,this.fileList=[],this.$refs.upload.clearFiles()},selectChange:function(t,e){this.fileList=e},beforeAvatarUpload:function(t,e){},successCheck:function(t,e,a){this.isUpload=!1,this.$refs.upload.clearFiles(),200==t.code?(this.uploadSoftPop=!1,this.$alert("上传成功","提示",{confirmButtonText:"确定",dangerouslyUseHTMLString:!0,closeOnClickModal:!0,type:"success"}).then(function(){}).catch(function(){}),this.getDataTable()):this.$message.error(t.msg)},removeFile:function(){this.fileList=[]},uploadErr:function(t,e,a){this.$message.error("导入失败")},exceed:function(){this.$message.error("不支持多文件上传")}}},n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content-wrapper"},[t._m(0),t._v(" "),a("section",{staticClass:"content container-fluid"},[a("div",{staticClass:"box box-primary"},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"box-body"},[a("div",{staticClass:" btn-group-box",staticStyle:{width:"100%"},attrs:{id:"toolbar"}},[a("div",{staticClass:"btn-group col-lg-5 pl-0"},[a("button",{staticClass:"btn btn-default",attrs:{id:"btn_add",type:"button"},on:{click:function(e){t.uploadSoftPop=!0}}},[a("span",{staticClass:"glyphicon glyphicon-plus",attrs:{"aria-hidden":"true"}}),t._v("新增\n                    ")])]),t._v(" "),a("div",{staticClass:"col-lg-7 pr-0 text-right"},[a("el-input",{staticStyle:{width:"200px"},attrs:{placeholder:"输入名称或版本号查询",clearable:"",size:"small"},model:{value:t.softForm.search,callback:function(e){t.$set(t.softForm,"search",e)},expression:"softForm.search"}}),t._v(" "),a("el-button",{staticClass:"mr-10",attrs:{type:"primary",size:"small"},on:{click:t.getDataTable}},[t._v("搜索")]),t._v(" "),a("el-dropdown",{attrs:{trigger:"click","hide-on-click":!1,placement:"bottom-start"}},[a("span",{staticClass:"el-dropdown-link"},[a("el-button",{attrs:{type:"primary",size:"small"}},[a("i",{staticClass:"el-icon-menu"}),t._v(" "),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})])],1),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-checkbox-group",{on:{change:t.checkboxChange},model:{value:t.tableSelect,callback:function(e){t.tableSelect=e},expression:"tableSelect"}},t._l(t.tableOption,function(t){return a("div",{key:t,staticClass:"checkbox-div"},[a("el-checkbox",{key:t,attrs:{label:t}})],1)}))],1)],1)],1)]),t._v(" "),a("table-cmp",{ref:"tableChild",attrs:{"table-data":t.tableData,"table-label":t.tableLabel,"is-show-select":t.isShowSelect}},[a("el-table-column",{attrs:{slot:"operate",label:"操作",align:"center",width:"100"},slot:"operate",scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-row",[a("el-button",{attrs:{title:"删除",type:"danger",icon:"el-icon-delete",round:"",size:"mini"},on:{click:function(a){t.deleteSoft(e.row.id)}}})],1)]}}])})],1),t._v(" "),a("div",{staticClass:"block mt-10"},[a("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[10,15,20,25],"page-size":10,layout:"total, sizes, prev, pager, next, jumper",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)])]),t._v(" "),a("el-dialog",{staticClass:"el-dialog-reset auth-pop",attrs:{title:"上传软件",visible:t.uploadSoftPop,"close-on-click-modal":!1,width:"500px"},on:{"update:visible":function(e){t.uploadSoftPop=e}}},[a("div",{staticStyle:{padding:"0px"}},[a("div",{staticClass:"row mb-20"},[a("div",{staticClass:"col-sm-4 text-right"},[t._v("请选择待上传的软件")]),t._v(" "),a("div",{staticClass:"col-sm-8 upload-zip"},[a("el-upload",{ref:"upload",attrs:{name:"file",limit:1,"with-credentials":!0,"file-list":t.fileList,action:t.exportUrl+"?appId="+t.appId,"auto-upload":!1,"on-exceed":t.exceed,"on-change":t.selectChange,"on-error":t.uploadErr,"before-upload":t.beforeAvatarUpload,"on-success":t.successCheck,"on-remove":t.removeFile}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[t._v("选取文件")]),t._v(" "),t.isUpload?t._e():a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:t.submitUpload}},[t._v("上传")]),t._v(" "),t.isUpload?a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{size:"small",type:"success"},on:{click:t.abortUpLoad}},[t._v("取消")]):t._e()],1)],1)])]),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.uploadSoftPop=!1}}},[t._v("关闭")])],1)]),t._v(" "),a("msg-box",{attrs:{popVisible:t.popVisible,popTitle:t.popTitle,popContent:t.popContent},on:{"update:popVisible":function(e){t.popVisible=e}}})],1)},r=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("section",{staticClass:"content-header"},[a("h1",{staticClass:"nice"},[t._v("\n      设备管理 - 软件管理\n        ")]),t._v(" "),a("ol",{staticClass:"breadcrumb"},[a("li",[a("a",{attrs:{href:"/"}},[a("i",{staticClass:"glyphicon glyphicon-home"}),t._v(" 首页\n          ")])]),t._v(" "),a("li",[a("i",{staticClass:"glyphicon glyphicon-hdd"}),t._v(" 设备管理\n        ")]),t._v(" "),a("li",{staticClass:"active"},[a("i",{staticClass:"glyphicon glyphicon-registration-mark"}),t._v(" 软件管理\n        ")])])])}],c={render:n,staticRenderFns:r},p=c,d=a("VU/8"),h=i,u=d(o,p,!1,h,"data-v-e2bb3f9c",null);e.default=u.exports},ecAN:function(t,e,a){var i=a("qq/P");"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);a("rjj0")("2e7d526d",i,!0)},"qq/P":function(t,e,a){e=t.exports=a("FZ+f")(!1),e.push([t.i,"\n.set-pop[data-v-e2bb3f9c] .el-range-editor.el-input__inner{width:50%\n}\n.set-pop[data-v-e2bb3f9c] .el-input,.set-pop[data-v-e2bb3f9c] .el-select{width:100%\n}\n.set-pop[data-v-e2bb3f9c] .el-select>.el-input{width:100%\n}\n.set-pop[data-v-e2bb3f9c] .el-dialog__footer{text-align:center\n}\n#canvas[data-v-e2bb3f9c]{width:400px;height:200px;position:relative;z-index:999999\n}\n.set-list[data-v-e2bb3f9c]{overflow:hidden\n}\n.set-list li[data-v-e2bb3f9c]{float:left;margin-right:25px;line-height:40px;border-bottom:3px solid transparent;cursor:pointer\n}\n.set-list li.active[data-v-e2bb3f9c]{border-bottom:3px solid #3c8dbc\n}\n.data-set-pop[data-v-e2bb3f9c] .el-select,.data-set-pop[data-v-e2bb3f9c] .el-input{width:400px\n}\n.upload-zip[data-v-e2bb3f9c] .el-upload-list__item{width:60%\n}\n.upload-zip[data-v-e2bb3f9c] .el-upload-list__item a{font-size:16px\n}\n.upload-zip[data-v-e2bb3f9c] .el-upload__input{display:none\n}\n",""])}});